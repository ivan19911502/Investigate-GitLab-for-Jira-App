# Интеграция Jira и GitLab

Полная документация по настройке и использованию интеграции между Jira и GitLab для синхронизации разработки в реальном времени.

---

## Оглавление

- [Введение](#введение)
- [Предварительные условия](#предварительные-условия)
- [Установка](#установка)
- [Рекомендуемая установка](#рекомендуемая-установка-для-self-hosted)
- [Возможности](#что-будет-доступно-после-интеграции)
- [Базовый рабочий процесс](#базовый-рабочий-процесс)
- [Автоматическое закрытие задач](#автоматическое-закрытие-задач)
- [Синхронизация комментариев](#синхронизация-комментариев)
- [CI/CD интеграция](#статус-сборки-и-cicd)
- [Отслеживание развертываний](#отслеживание-развертываний)
- [Продвинутые сценарии](#продвинутые-сценарии)
- [Лучшие практики](#лучшие-практики-использования)
- [Шпаргалка](#шпаргалка-команды-и-примеры)

---

## Введение

Интеграция Jira и GitLab позволяет автоматически синхронизировать информацию о разработке между двумя системами:

**Связывание** - Автоматическое связывание коммитов, веток и MR с задачами Jira

**Автоматизация** - Автоматическое изменение статуса задач при слиянии кода

**Синхронизация** - Двусторонняя синхронизация комментариев и информации

---

## Предварительные условия

Для успешной интеграции вам понадобится:

| Требование | Версия |
|-----------|--------|
| Jira Cloud | Cloud версия или Data Center 4.4.0+ |
| GitLab | 10.0+ (Self-Managed) или GitLab.com |
| Права доступа | Admin в Jira, Maintainer в GitLab |
| API токен | Создан в Jira |

### Время настройки

- Self-Hosted интеграция: 10-15 минут
- Полная конфигурация: 20-30 минут

---

## Рекомендуемая установка для Self-Hosted

### Способ 1: Jira Issues Integration (Рекомендуется)

#### Настройка в GitLab

1. Перейдите в параметры проекта
   ```
   Проект → Settings → Integrations
   ```

2. Найдите и откройте "Jira issues"

3. Включите интеграцию (Enable integration)

4. Заполните данные подключения
   ```
   Web URL:    http://jira.your-company.local:8080
   Email:      admin@company.com
   API Token:  скопированный токен из Jira
   ```

5. Выберите триггеры синхронизации
   - [x] Push events (коммиты)
   - [x] Merge request events
   - [ ] Comments
   - [ ] Transitions

6. Протестируйте соединение
   ```
   Нажмите "Test settings"
   ```

7. Сохраните параметры
   ```
   Нажмите "Save changes"
   ```

**ГОТОВО!** Интеграция активна.

---

## Что будет доступно после интеграции?

### Связывание

Автоматическое связывание коммитов, веток и MR с задачами Jira:

- Коммиты с упоминанием ключа задачи
- Ветки с названием, содержащим ключ
- Merge Requests связанные с задачей

### Автоматизация

Автоматическое изменение статуса задач:

- Статус "In Progress" при создании MR
- Статус "Done" при слиянии MR
- Добавление комментариев с информацией

---

## Базовый рабочий процесс

### Основной принцип

Когда вы упоминаете ключ задачи Jira (например, `PROJ-123`) в коммитах, ветках или MR, GitLab автоматически связывает эти элементы с задачей.

### Пошаговый процесс

#### Шаг 1: Вы создаете ветку в GitLab

```bash
git checkout -b PROJ-123-fix-login-bug
```

#### Шаг 2: Вы делаете коммит с упоминанием задачи

```bash
git commit -m "PROJ-123: Исправить ошибку при входе пользователя

- Добавлена валидация email
- Исправлена ошибка 404
- Добавлены unit-тесты"
```

#### Шаг 3: Вы создаете Merge Request

```bash
git push origin PROJ-123-fix-login-bug
```

На GitLab создаете MR с названием:
```
PROJ-123: Fix user login error
```

#### Шаг 4: MR одобрили и слили

На GitLab нажимаете "Merge"

Статус задачи автоматически изменится на "Done"

---

## Автоматическое закрытие задач

### Ключевые слова для закрытия

Используйте специальные слова, и задача закроется при слиянии MR.

| Ключевое слово | Пример |
|---|---|
| Fixes, Fixed, Fix | `Fixes PROJ-123` |
| Resolves, Resolved, Resolve | `Resolves PROJ-123` |
| Closes, Closed, Close | `Closes PROJ-123` |

### Примеры

#### Простое закрытие

```bash
git commit -m "Fixes PROJ-123: Исправлен критический баг"
```

#### Несколько задач

```bash
git commit -m "Fixes PROJ-123, PROJ-456, PROJ-789: Исправить баг"
```

---

## Синхронизация комментариев

### Двусторонняя синхронизация

Комментарии в Jira видны в GitLab и наоборот.

---

## Статус сборки и CI/CD

### Автоматическая информация о сборках

Если настроен CI/CD пайплайн в GitLab, информация о статусе сборки будет видна в Jira:

- Статус каждого job (passed/failed/running)
- Время выполнения
- Логи ошибок
- Автоматическое обновление

---

## Отслеживание развертываний

### Development информация в Production

После слияния кода, информация об этом будет в Jira:

- Окружение (staging/production)
- Статус развертывания
- Время развертывания
- Количество зафиксированных изменений

---

## Лучшие практики использования

### 1. Всегда указывайте ключ задачи в ветке

```bash
git checkout -b PROJ-123-описание
```

### 2. Используйте ключевые слова в коммитах

```bash
git commit -m "Fixes PROJ-123: Описание исправления"
```

### 3. Детальные сообщения коммитов

```bash
git commit -m "PROJ-123: Добавить новую фичу

- Что было добавлено
- Почему это нужно
- Как это протестировано"
```

### 4. Связывайте связанные задачи

Если PROJ-123 связан с PROJ-456, упомяните это в комментариях

### 5. Используйте MR описания

Добавляйте в MR: описание, тесты, скриншоты

### 6. Регулярно проверяйте Development Panel

Убедитесь, что все связи работают правильно

---

## Частые ошибки

### Ошибка: Опечатка в ключе задачи

```bash
# Неправильно:
git commit -m "PROJ_123: Описание"  # подчеркивание

# Правильно:
git commit -m "PROJ-123: Описание"  # дефис
```

### Другие частые ошибки

- Забыли указать ключ в коммите
- Используете пароль вместо API-токена
- Коммит после закрытия MR

---

## Шпаргалка: Команды и примеры

### Создание ветки

```bash
git checkout -b PROJ-123-feature-name
```

### Коммит с автозакрытием

```bash
git commit -m "Fixes PROJ-123: Описание"
```

### Коммит со связыванием

```bash
git commit -m "PROJ-123: Добавить фичу

Детали:
- Реализовано
- Протестировано
- Связано с PROJ-456"
```

### Отправка и создание MR

```bash
git push origin PROJ-123-feature-name
```

### Несколько задач в одном коммите

```bash
git commit -m "Fixes PROJ-123, PROJ-456, PROJ-789: Исправить баг"
```

---

## Решение проблем

### "Unauthorized" ошибка авторизации

Решение:
- Email должен совпадать с email аккаунта Jira
- API-токен должен быть создан на Atlassian Account
- Токен не должен быть истекшим

### Данные не синхронизируются

Решение:
- Проверьте, содержит ли коммит ключ Jira
- Убедитесь, что проект существует в Jira
- Интеграция должна быть включена
- Подождите несколько минут

---

## Итого

После настройки интеграции вы получите:

- Полная синхронизация разработки
- Автоматическое связывание
- Автоматическое изменение статусов
- Двусторонняя синхронизация
- Полная видимость CI/CD
- Улучшенная командная работа

